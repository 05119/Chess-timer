<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chess Timer</title>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      font-family: sans-serif;
    }

    #controls {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 10px;
      background: #222;
      color: white;
      gap: 10px;
    }

    #controls input {
      width: 60px;
      font-size: 1em;
      padding: 4px;
    }

    #controls button {
      padding: 6px 12px;
      font-size: 1em;
      cursor: pointer;
    }

    .container {
      display: flex;
      flex-direction: column;
      height: calc(100% - 50px);
      width: 100%;
    }

    .player {
      flex-grow: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3em;
      color: white;
      transition: flex-grow 0.2s linear;
      cursor: pointer;
      user-select: none;
    }

    .player1 {
      background-color: #1e90ff;
    }

    .player2 {
      background-color: #ff6347;
    }

    .active {
      outline: 5px solid yellow;
    }
  </style>
</head>
<body>

  <div id="controls">
    <label for="startTime">Minutes:</label>
    <input type="number" id="startTime" value="5" min="1" max="60" />
    <button id="startBtn">Start</button>
    <button id="resetBtn">Reset</button>
  </div>

  <div class="container">
    <div class="player player1" id="player1">00:00</div>
    <div class="player player2" id="player2">00:00</div>
  </div>

  <audio id="beep" src="https://www.soundjay.com/button/beep-07.wav" preload="auto"></audio>

  <script>
    const player1El = document.getElementById('player1');
    const player2El = document.getElementById('player2');
    const startBtn = document.getElementById('startBtn');
    const resetBtn = document.getElementById('resetBtn');
    const startTimeInput = document.getElementById('startTime');
    const beepSound = document.getElementById('beep');

    let totalTime = 300;
    let time1 = totalTime;
    let time2 = totalTime;
    let activePlayer = null;
    let interval = null;

    function formatTime(t) {
      const min = Math.floor(t / 60);
      const sec = t % 60;
      return `${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
    }

    function updateUI() {
      player1El.textContent = formatTime(time1);
      player2El.textContent = formatTime(time2);
      player1El.style.flexGrow = time1 / totalTime;
      player2El.style.flexGrow = time2 / totalTime;
    }

    function switchPlayer(player) {
      if (activePlayer === player) return;
      clearInterval(interval);

      player1El.classList.remove('active');
      player2El.classList.remove('active');
      activePlayer = player;

      if (player === 1) {
        player1El.classList.add('active');
        interval = setInterval(() => {
          if (time1 > 0) {
            time1--;
            updateUI();
          } else {
            clearInterval(interval);
            beepSound.play();
            alert("Player 1's time is up!");
          }
        }, 1000);
      } else {
        player2El.classList.add('active');
        interval = setInterval(() => {
          if (time2 > 0) {
            time2--;
            updateUI();
          } else {
            clearInterval(interval);
            beepSound.play();
            alert("Player 2's time is up!");
          }
        }, 1000);
      }
    }

    function resetGame() {
      clearInterval(interval);
      player1El.classList.remove('active');
      player2El.classList.remove('active');
      activePlayer = null;
      const minutes = parseInt(startTimeInput.value) || 5;
      totalTime = minutes * 60;
      time1 = totalTime;
      time2 = totalTime;
      updateUI();
    }

    // Event bindings
    player1El.addEventListener('click', () => {
      if (activePlayer !== null) switchPlayer(2);
    });

    player2El.addEventListener('click', () => {
      if (activePlayer !== null) switchPlayer(1);
    });

    startBtn.addEventListener('click', () => {
      resetGame(); // ensure timers are reset
      switchPlayer(1); // start with Player 1
    });

    resetBtn.addEventListener('click', resetGame);

    resetGame(); // Initial UI setup
  </script>
</body>
</html>
